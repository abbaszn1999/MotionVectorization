cat motion_vectorization/logs/test1_optim_*.out  # إذا كان موجوداً
total 48311
drwxrwxrwx  5 root root  2005688 Sep  9 21:20 .
drwxrwxrwx  3 root root  2005688 Sep  9 21:00 ..
-rw-rw-rw-  1 root root     1112 Sep  9 22:29 arg.pkl
drwxrwxrwx 17 root root  2001711 Sep  9 21:00 debug
drwxrwxrwx  5 root root  1025339 Sep  9 21:00 outputs
drwxrwxrwx  2 root root  1000390 Sep  9 21:20 shapes
-rw-rw-rw-  1 root root 41428004 Sep  9 22:29 time_bank.pkl
test1_optim_1141.out   test1_optim_16044.out  test1_optim_23838.out  test1_optim_741.out    test1_track_13342.out  test1_track_17339.out  test1_track_26864.out  test1_track_8986.out
test1_optim_1142.out   test1_optim_22950.out  test1_optim_29382.out  test1_optim_7424.out   test1_track_15071.out  test1_track_19109.out  test1_track_29752.out  test1_track_9207.out
test1_optim_14479.out  test1_optim_2353.out   test1_optim_29797.out  test1_optim_8888.out   test1_track_15692.out  test1_track_239.out    test1_track_30225.out
test1_optim_1512.out   test1_optim_23705.out  test1_optim_4271.out   test1_track_11913.out  test1_track_1618.out   test1_track_25382.out  test1_track_7103.out
2025-09-09 21:00:48.813307
[WARNING] Configs file not found! Using default.json instead.
Configs:
  video_file:   test1.mp4
  video_dir:    videos
  output_dir:   motion_vectorization/outputs
  suffix:       None
  config:       motion_vectorization/config/test1.json
  date: None
  frame_rate:   24
  subsample_rate:       1
  max_frames:   300
  start_frame:  0
  scale:        0.3
  bg_thresh:    0.1
  min_cluster_size:     50
  median_radius:        5
  cluster_eps:  5
  cluster_min_samples:  10
  bg_file:      None
  init_weight:  0.0
  init_thresh:  0.01
  num_match_shapes:     -1
  match_radius: 120.0
  main_match_thresh:    0.6
  fallback_match_thresh:        0.6
  match_method: hu
  min_opt_size: 256
  blur_kernel:  3
  lr:   0.01
  p_weight:     0.01
  use_z:        True
  n_steps:      50
  use_gpu:      False
  bleed:        50
  all_joint:    False
  overlap_thresh:       0.5
  manual_init:  False
  use_k:        True
  use_r:        True
  use_s:        True
  use_t:        True
  init_r:       True
  init_s:       True
  init_t:       True
  drop_thresh:  0.1
  snap_thresh:  3
  scale_thresh: 0.03
  angle_thresh: 0.0
  debug:        False
  verbose:      True
  show: False
  show_optim:   False
  show_recon:   False
  checkpoint:   False
  base_frame:   0
  shapes:       None
  min_density:  0.15
  min_dim:      5
  max_radius:   3
  add_contrast: True
  lo_thresh:    30
  hi_thresh:    100
  link: False
  single_match_thresh:  0.05
  breaks:       []
  multiply:     False
device: cpu
(base) root@30fb68955ee8:/workspace/MotionVectorization# # إنشاء config محسن مع GPU
cat > motion_vectorization/config/test1_gpu.json << 'EOF'
{
  "video_file": "test1.mp4",
  "output_dir": "motion_vectorization/outputs", 
  "use_gpu": true,
  "n_steps": 10,
  "lr": 0.05,
  "min_opt_size": 128,
  "p_weight": 0.05
}
EOF

# تشغيل OPTIM مع GPU وإعدادات سريعة
python3 -m motion_vectorization.optimize_shapes --video_file test1.mp4 --config motion_vectorization/config/test1_gpu.json
2025-09-09 22:47:33.449802
Configs:
  video_file:   test1.mp4
  video_dir:    videos
  output_dir:   motion_vectorization/outputs
  suffix:       None
  config:       motion_vectorization/config/test1_gpu.json
  date: None
  frame_rate:   24
  subsample_rate:       1
  max_frames:   -1
  start_frame:  1
  scale:        0.3
  bg_thresh:    0.1
  min_cluster_size:     50
  median_radius:        5
  cluster_eps:  5
  cluster_min_samples:  10
  bg_file:      None
  init_weight:  0.0
  init_thresh:  0.01
  num_match_shapes:     5
  match_radius: 120.0
  main_match_thresh:    0.5
  fallback_match_thresh:        0.5
  match_method: hu
  min_opt_size: 128
  blur_kernel:  3
  lr:   0.05
  p_weight:     0.05
  use_z:        True
  n_steps:      10
  use_gpu:      True
  bleed:        50
  all_joint:    False
  overlap_thresh:       0.9
  manual_init:  False
  use_k:        False
  use_r:        False
  use_s:        False
  use_t:        False
  init_r:       False
  init_s:       False
  init_t:       False
  drop_thresh:  0.005
  snap_thresh:  3
  scale_thresh: 0.03
  angle_thresh: 5.0
  debug:        False
  verbose:      False
  show: False
  show_optim:   False
  show_recon:   False
  checkpoint:   False
device: cuda
[NOTE] 
Shapes: dict_keys([0])

FRAME 2 (1) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
/usr/local/lib/python3.11/dist-packages/torch/nn/functional.py:4236: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  warnings.warn(
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.97s
[NOTE] Optimizing...
/usr/local/lib/python3.11/dist-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
[TIME] Processing frame 2 took 9.10s

FRAME 3 (2) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.64s
[NOTE] Optimizing...
[TIME] Processing frame 3 took 9.11s

FRAME 4 (3) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.53s
[NOTE] Optimizing...
[TIME] Processing frame 4 took 8.63s

FRAME 5 (4) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.52s
[NOTE] Optimizing...
[TIME] Processing frame 5 took 8.76s

FRAME 6 (5) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.47s
[NOTE] Optimizing...
[TIME] Processing frame 6 took 9.34s

FRAME 7 (6) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.54s
[NOTE] Optimizing...
[TIME] Processing frame 7 took 9.13s

FRAME 8 (7) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.41s
[NOTE] Optimizing...
[TIME] Processing frame 8 took 8.75s

FRAME 9 (8) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.50s
[NOTE] Optimizing...
[TIME] Processing frame 9 took 8.88s

FRAME 10 (9) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.50s
[NOTE] Optimizing...
[TIME] Processing frame 10 took 8.71s

FRAME 11 (10) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.58s
[NOTE] Optimizing...
[TIME] Processing frame 11 took 8.59s

FRAME 12 (11) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.58s
[NOTE] Optimizing...
[TIME] Processing frame 12 took 8.59s

FRAME 13 (12) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.73s
[NOTE] Optimizing...
[TIME] Processing frame 13 took 8.55s

FRAME 14 (13) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.73s
[NOTE] Optimizing...
[TIME] Processing frame 14 took 5.53s

FRAME 15 (14) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.66s
[NOTE] Optimizing...
[TIME] Processing frame 15 took 8.43s

FRAME 16 (15) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.63s
[NOTE] Optimizing...
[TIME] Processing frame 16 took 9.27s

FRAME 17 (16) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.60s
[NOTE] Optimizing...
[TIME] Processing frame 17 took 9.05s

FRAME 18 (17) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.50s
[NOTE] Optimizing...
[TIME] Processing frame 18 took 8.64s

FRAME 19 (18) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.51s
[NOTE] Optimizing...
[TIME] Processing frame 19 took 8.63s

FRAME 20 (19) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.49s
[NOTE] Optimizing...
[TIME] Processing frame 20 took 8.82s

FRAME 21 (20) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.45s
[NOTE] Optimizing...
[TIME] Processing frame 21 took 8.61s

FRAME 22 (21) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.39s
[NOTE] Optimizing...
[TIME] Processing frame 22 took 8.41s

FRAME 23 (22) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.47s
[NOTE] Optimizing...
[TIME] Processing frame 23 took 8.49s

FRAME 24 (23) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.52s
[NOTE] Optimizing...
[TIME] Processing frame 24 took 8.63s

FRAME 25 (24) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.66s
[NOTE] Optimizing...
[TIME] Processing frame 25 took 8.90s

FRAME 26 (25) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.89s
[NOTE] Optimizing...
[TIME] Processing frame 26 took 9.12s

FRAME 27 (26) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.89s
[NOTE] Optimizing...
[TIME] Processing frame 27 took 9.31s

FRAME 28 (27) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.80s
[NOTE] Optimizing...
[TIME] Processing frame 28 took 6.70s

FRAME 29 (28) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.79s
[NOTE] Optimizing...
[TIME] Processing frame 29 took 9.05s

FRAME 30 (29) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.75s
[NOTE] Optimizing...
[TIME] Processing frame 30 took 9.12s

FRAME 31 (30) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.66s
[NOTE] Optimizing...
[TIME] Processing frame 31 took 9.16s

FRAME 32 (31) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.63s
[NOTE] Optimizing...
[TIME] Processing frame 32 took 8.79s

FRAME 33 (32) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.51s
[NOTE] Optimizing...
[TIME] Processing frame 33 took 8.21s

FRAME 34 (33) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.37s
[NOTE] Optimizing...
[TIME] Processing frame 34 took 8.15s

FRAME 35 (34) CLUSTERS
========================
[VARS] Active shapes: [0]
[VARS] fg_comp_to_label: defaultdict(<class 'list'>, {1: [0]})
[NOTE] Collecting component groups...
[NOTE] Fallback angle used!
[TIME] Collecting comps took 1.37s
[NOTE] Optimizing...
[TIME] Processing frame 35 took 8.56s
[NOTE] Shape bank saved to: motion_vectorization/outputs/test1_None/shape_bank.pkl
(base) root@30fb68955ee8:/workspace/MotionVectorization# # فحص آخر سجل OPTIM لفهم سبب التوقف
tail -50 motion_vectorization/logs/test1_optim_29797.out

# التحقق من وجود GPU
nvidia-smi
python3 -c "import torch; print(f'CUDA available: {torch.cuda.is_available()}')"
Tue Sep  9 22:52:45 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.20             Driver Version: 570.133.20     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A6000               On  |   00000000:0F:00.0 Off |                  Off |
| 30%   26C    P8             22W /  300W |       0MiB /  49140MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
CUDA available: True
(base) root@30fb68955ee8:/workspace/MotionVectorization# 